# JavaScript: структуры данных и алгоритмы. Часть 4

## 12. Дерево отрезков

Описание

[Википедия](https://ru.wikipedia.org/wiki/%D0%94%D0%B5%D1%80%D0%B5%D0%B2%D0%BE_%D0%BE%D1%82%D1%80%D0%B5%D0%B7%D0%BA%D0%BE%D0%B2)

[YouTube](https://www.youtube.com/watch?v=LEkEPE_BKQY)

Дерево отрезков (сегментов) (segment tree), также известное как статистическое дерево (statistic tree) — это структура данных, которая используется для хранения информации об отрезках (сегментах, диапазонах). Эта структура данных позволяет запрашивать, какой сегмент содержит определенное значение. По сути, дерево отрезков является статичной структурой данных — ее структура не может меняться после создания.

Дерево отрезков — это двоичное дерево (binary tree, см. часть 3, раздел 9). Корень дерева представляет весь массив. Потомки дерева представляют левую и правую половины массива. Аналогично, потомки каждого узла представляют половины массива, соответствующего узлу.

Дерево строится снизу вверх. Значение предка — это значение минимального потомка (или другое значение в зависимости от переданной функции). Построение дерева занимает время O(n log n). Количество операций — это высота дерева и равняется O(n log n). Для выполнения запросов диапазона (range queries) каждый узел разбивает запрос на две части, по одному подзапросу для каждого потомка. Если запрос содержит весь подмассив узла, мы можем вернуть предварительно вычисленное значение узла. Эта оптимизация позволяет добиться O(n log n) операций.


![Дерево отрезков](https://habrastorage.org/r/w1560/webt/gi/i6/uy/gii6uyehmtmmktqk9hlkz8zj0_w.png)

![Дерево отрезков](https://habrastorage.org/r/w1560/webt/kw/ah/sd/kwahsdixbt1ir6lu1uvpgaph3ak.png)

Случаи применения


Дерево отрезков — это структура данных, спроектированная для эффективного выполнения некоторых операций с массивами, особенно, операций, включающих запросы диапазона.


Такие деревья часто применяются в вычислительной геометрии и географических информационных системах.


Наша реализация дерева отрезков будет принимать любую функцию (принимающую два параметра), позволяя выполнять разные запросы диапазона.


Интерактивную визуализацию дерева отрезков можно посмотреть [здесь.](https://visualgo.net/en/segmenttree)

### Сложность

Временная


|Поиск	   |Запрос диапазона|
|----------|----------------|
|O(log(n)) |O(log(n))       |

Пространственная

O(n)

